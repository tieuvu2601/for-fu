function doHighlight(bodyText,searchTerm,highlightStartTag,highlightEndTag){if((!highlightStartTag)||(!highlightEndTag)){highlightStartTag="<em style='color:blue; background-color:yellow;'>";highlightEndTag="</em>"}var newText="";var i=-1;var lcSearchTerm=searchTerm.toLowerCase();var lcBodyText=bodyText.toLowerCase();while(bodyText.length>0){i=lcBodyText.indexOf(lcSearchTerm,i+1);if(i<0){newText+=bodyText;bodyText=""}else{if(bodyText.lastIndexOf(">",i)>=bodyText.lastIndexOf("<",i)){if(lcBodyText.lastIndexOf("/script>",i)>=lcBodyText.lastIndexOf("<script",i)){newText+=bodyText.substring(0,i)+highlightStartTag+bodyText.substr(i,searchTerm.length)+highlightEndTag;bodyText=bodyText.substr(i+searchTerm.length);lcBodyText=bodyText.toLowerCase();i=-1}}}}return newText}function highlightSearchTerms(searchText,treatAsPhrase,warnOnFailure,highlightStartTag,highlightEndTag){if(treatAsPhrase){searchArray=[searchText]}else{searchArray=searchText.split(" ")}if(!document.body||typeof(document.body.innerHTML)=="undefined"){if(warnOnFailure){alert("Sorry, for some reason the text of this page is unavailable. Searching will not work.")}return false}var bodyText=document.body.innerHTML;for(var i=0;i<searchArray.length;i++){bodyText=doHighlight(bodyText,searchArray[i],highlightStartTag,highlightEndTag)}document.body.innerHTML=bodyText;return true}function removeHighlight(){var arr=document.getElementsByTagName("em");while(arr.length&&(el=arr[0])){el.parentNode.replaceChild(el.firstChild,el)}}function doSearchText(searchText){removeHighlight();highlightSearchTerms(searchText,true)};